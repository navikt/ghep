{
  "action": "created",
  "alert": {
    "number": 27,
    "created_at": "2025-06-06T08:55:42Z",
    "updated_at": "2025-06-06T08:55:42Z",
    "url": "https://api.github.com/repos/nais/deploy/code-scanning/alerts/27",
    "html_url": "https://github.com/nais/deploy/security/code-scanning/27",
    "state": "open",
    "fixed_at": null,
    "dismissed_by": null,
    "dismissed_at": null,
    "dismissed_reason": null,
    "dismissed_comment": null,
    "rule": {
      "id": "actions/missing-workflow-permissions",
      "severity": "warning",
      "description": "Workflow does not contain permissions",
      "name": "actions/missing-workflow-permissions",
      "tags": [
        "actions",
        "external/cwe/cwe-275",
        "maintainability",
        "security"
      ],
      "full_description": "Workflows should contain explicit permissions to restrict the scope of the default GITHUB_TOKEN.",
      "help": "# Actions Job and Workflow Permissions are not set\n\n## Description\n\nIf a GitHub Actions job or workflow has no explicit permissions set, then the repository permissions are used. Repositories created under organizations inherit the organization permissions. The organizations or repositories created before February 2023 have the default permissions set to read-write. Often these permissions do not adhere to the principle of least privilege and can be reduced to read-only, leaving the `write` permission only to a specific types as `issues: write` or `pull-requests: write`.\n\n## Recommendations\n\nAdd the `permissions` key to the job or the root of workflow (in this case it is applied to all jobs in the workflow that do not have their own `permissions` key) and assign the least privileges required to complete the task:\n\n```yaml\nname: \"My workflow\"\npermissions:\n  contents: read\n  pull-requests: write\n```\n\nor\n\n```yaml\njobs:\n  my-job:\n    permissions:\n      contents: read\n      pull-requests: write\n```\n\n## References\n\n- [Assigning permissions to jobs](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/assigning-permissions-to-jobs)\n",
      "security_severity_level": "medium"
    },
    "tool": {
      "name": "CodeQL",
      "guid": null,
      "version": "2.21.4"
    },
    "most_recent_instance": {
      "ref": "refs/heads/master",
      "analysis_key": "dynamic/github-code-scanning/codeql:upload",
      "environment": "{}",
      "category": "/language:actions",
      "state": "open",
      "commit_sha": "0738eae660ae7530c16d943f6da824b3008c84eb",
      "message": {
        "text": "Actions job or workflow does not limit the permissions of the GITHUB_TOKEN. Consider setting an explicit permissions block, using the following as a minimal starting point: {{contents: read}}"
      },
      "location": {
        "path": ".github/workflows/test-job.yaml",
        "start_line": 13,
        "end_line": 22,
        "start_column": 5,
        "end_column": 37
      },
      "classifications": ["test"]
    },
    "instances_url": "https://api.github.com/repos/nais/deploy/code-scanning/alerts/27/instances",
    "dismissal_approved_by": null
  },
  "ref": "refs/heads/master",
  "commit_oid": "0738eae660ae7530c16d943f6da824b3008c84eb",
  "repository": {
    "id": 166402203,
    "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0MDIyMDM=",
    "name": "deploy",
    "full_name": "nais/deploy",
    "private": false,
    "owner": {
      "login": "nais",
      "id": 29488289,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjI5NDg4Mjg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/29488289?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nais",
      "html_url": "https://github.com/nais",
      "followers_url": "https://api.github.com/users/nais/followers",
      "following_url": "https://api.github.com/users/nais/following{/other_user}",
      "gists_url": "https://api.github.com/users/nais/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nais/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nais/subscriptions",
      "organizations_url": "https://api.github.com/users/nais/orgs",
      "repos_url": "https://api.github.com/users/nais/repos",
      "events_url": "https://api.github.com/users/nais/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nais/received_events",
      "type": "Organization",
      "user_view_type": "public",
      "site_admin": false
    },
    "html_url": "https://github.com/nais/deploy",
    "description": "Nais deploy: multi-cluster Kubernetes deployments",
    "fork": false,
    "url": "https://api.github.com/repos/nais/deploy",
    "forks_url": "https://api.github.com/repos/nais/deploy/forks",
    "keys_url": "https://api.github.com/repos/nais/deploy/keys{/key_id}",
    "collaborators_url": "https://api.github.com/repos/nais/deploy/collaborators{/collaborator}",
    "teams_url": "https://api.github.com/repos/nais/deploy/teams",
    "hooks_url": "https://api.github.com/repos/nais/deploy/hooks",
    "issue_events_url": "https://api.github.com/repos/nais/deploy/issues/events{/number}",
    "events_url": "https://api.github.com/repos/nais/deploy/events",
    "assignees_url": "https://api.github.com/repos/nais/deploy/assignees{/user}",
    "branches_url": "https://api.github.com/repos/nais/deploy/branches{/branch}",
    "tags_url": "https://api.github.com/repos/nais/deploy/tags",
    "blobs_url": "https://api.github.com/repos/nais/deploy/git/blobs{/sha}",
    "git_tags_url": "https://api.github.com/repos/nais/deploy/git/tags{/sha}",
    "git_refs_url": "https://api.github.com/repos/nais/deploy/git/refs{/sha}",
    "trees_url": "https://api.github.com/repos/nais/deploy/git/trees{/sha}",
    "statuses_url": "https://api.github.com/repos/nais/deploy/statuses/{sha}",
    "languages_url": "https://api.github.com/repos/nais/deploy/languages",
    "stargazers_url": "https://api.github.com/repos/nais/deploy/stargazers",
    "contributors_url": "https://api.github.com/repos/nais/deploy/contributors",
    "subscribers_url": "https://api.github.com/repos/nais/deploy/subscribers",
    "subscription_url": "https://api.github.com/repos/nais/deploy/subscription",
    "commits_url": "https://api.github.com/repos/nais/deploy/commits{/sha}",
    "git_commits_url": "https://api.github.com/repos/nais/deploy/git/commits{/sha}",
    "comments_url": "https://api.github.com/repos/nais/deploy/comments{/number}",
    "issue_comment_url": "https://api.github.com/repos/nais/deploy/issues/comments{/number}",
    "contents_url": "https://api.github.com/repos/nais/deploy/contents/{+path}",
    "compare_url": "https://api.github.com/repos/nais/deploy/compare/{base}...{head}",
    "merges_url": "https://api.github.com/repos/nais/deploy/merges",
    "archive_url": "https://api.github.com/repos/nais/deploy/{archive_format}{/ref}",
    "downloads_url": "https://api.github.com/repos/nais/deploy/downloads",
    "issues_url": "https://api.github.com/repos/nais/deploy/issues{/number}",
    "pulls_url": "https://api.github.com/repos/nais/deploy/pulls{/number}",
    "milestones_url": "https://api.github.com/repos/nais/deploy/milestones{/number}",
    "notifications_url": "https://api.github.com/repos/nais/deploy/notifications{?since,all,participating}",
    "labels_url": "https://api.github.com/repos/nais/deploy/labels{/name}",
    "releases_url": "https://api.github.com/repos/nais/deploy/releases{/id}",
    "deployments_url": "https://api.github.com/repos/nais/deploy/deployments",
    "created_at": "2019-01-18T12:33:03Z",
    "updated_at": "2025-06-06T08:42:18Z",
    "pushed_at": "2025-06-06T08:46:51Z",
    "git_url": "git://github.com/nais/deploy.git",
    "ssh_url": "git@github.com:nais/deploy.git",
    "clone_url": "https://github.com/nais/deploy.git",
    "svn_url": "https://github.com/nais/deploy",
    "homepage": "https://doc.nais.io/build/how-to/build-and-deploy",
    "size": 4911,
    "stargazers_count": 2,
    "watchers_count": 2,
    "language": "Go",
    "has_issues": true,
    "has_projects": false,
    "has_downloads": true,
    "has_wiki": false,
    "has_pages": false,
    "has_discussions": false,
    "forks_count": 8,
    "mirror_url": null,
    "archived": false,
    "disabled": false,
    "open_issues_count": 8,
    "license": {
      "key": "mit",
      "name": "MIT License",
      "spdx_id": "MIT",
      "url": "https://api.github.com/licenses/mit",
      "node_id": "MDc6TGljZW5zZTEz"
    },
    "allow_forking": true,
    "is_template": false,
    "web_commit_signoff_required": false,
    "topics": ["kubernetes", "nais", "naiserator"],
    "visibility": "public",
    "forks": 8,
    "open_issues": 8,
    "watchers": 2,
    "default_branch": "master",
    "custom_properties": {}
  },
  "organization": {
    "login": "nais",
    "id": 29488289,
    "node_id": "MDEyOk9yZ2FuaXphdGlvbjI5NDg4Mjg5",
    "url": "https://api.github.com/orgs/nais",
    "repos_url": "https://api.github.com/orgs/nais/repos",
    "events_url": "https://api.github.com/orgs/nais/events",
    "hooks_url": "https://api.github.com/orgs/nais/hooks",
    "issues_url": "https://api.github.com/orgs/nais/issues",
    "members_url": "https://api.github.com/orgs/nais/members{/member}",
    "public_members_url": "https://api.github.com/orgs/nais/public_members{/member}",
    "avatar_url": "https://avatars.githubusercontent.com/u/29488289?v=4",
    "description": "Nav Application Infrastructure Service"
  },
  "enterprise": {
    "id": 371,
    "slug": "nav",
    "name": "Nav",
    "node_id": "MDEwOkVudGVycHJpc2UzNzE=",
    "avatar_url": "https://avatars.githubusercontent.com/b/371?v=4",
    "description": "",
    "website_url": "https://nav.no",
    "html_url": "https://github.com/enterprises/nav",
    "created_at": "2019-06-26T11:17:54Z",
    "updated_at": "2025-05-05T17:51:43Z"
  },
  "sender": {
    "login": "github",
    "id": 9919,
    "node_id": "MDEyOk9yZ2FuaXphdGlvbjk5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github",
    "html_url": "https://github.com/github",
    "followers_url": "https://api.github.com/users/github/followers",
    "following_url": "https://api.github.com/users/github/following{/other_user}",
    "gists_url": "https://api.github.com/users/github/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github/subscriptions",
    "organizations_url": "https://api.github.com/users/github/orgs",
    "repos_url": "https://api.github.com/users/github/repos",
    "events_url": "https://api.github.com/users/github/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github/received_events",
    "type": "Organization",
    "user_view_type": "public",
    "site_admin": false
  },
  "installation": {
    "id": 56621983,
    "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uNTY2MjE5ODM="
  }
}
