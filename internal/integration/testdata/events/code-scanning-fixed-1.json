{
  "action": "fixed",
  "alert": {
    "number": 10,
    "created_at": "2023-01-06T13:55:36Z",
    "updated_at": "2023-01-06T18:43:46Z",
    "url": "https://api.github.com/repos/nais/deploy/code-scanning/alerts/10",
    "html_url": "https://github.com/nais/deploy/security/code-scanning/10",
    "state": "dismissed",
    "fixed_at": "2025-06-06T11:39:20Z",
    "dismissed_by": {
      "login": "mortenlj",
      "id": 746078,
      "node_id": "MDQ6VXNlcjc0NjA3OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/746078?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mortenlj",
      "html_url": "https://github.com/mortenlj",
      "followers_url": "https://api.github.com/users/mortenlj/followers",
      "following_url": "https://api.github.com/users/mortenlj/following{/other_user}",
      "gists_url": "https://api.github.com/users/mortenlj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mortenlj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mortenlj/subscriptions",
      "organizations_url": "https://api.github.com/users/mortenlj/orgs",
      "repos_url": "https://api.github.com/users/mortenlj/repos",
      "events_url": "https://api.github.com/users/mortenlj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mortenlj/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    },
    "dismissed_at": "2023-01-06T18:43:46Z",
    "dismissed_reason": "won't fix",
    "dismissed_comment": null,
    "rule": {
      "id": "go/log-injection",
      "severity": "error",
      "description": "Log entries created from user input",
      "name": "go/log-injection",
      "tags": ["external/cwe/cwe-117", "security"],
      "full_description": "Building log entries from user-controlled sources is vulnerable to insertion of forged log entries by a malicious user.",
      "help": "# Log entries created from user input\nIf unsanitized user input is written to a log entry, a malicious user may be able to forge new log entries.\n\nForgery can occur if a user provides some input with characters that are interpreted when the log output is displayed. If the log is displayed as a plain text file, then new line characters can be used by a malicious user. If the log is displayed as HTML, then arbitrary HTML may be included to spoof log entries.\n\n\n## Recommendation\nUser input should be suitably encoded before it is logged.\n\nIf the log entries are plain text then line breaks should be removed from user input, using `strings.Replace` or similar. Care should also be taken that user input is clearly marked in log entries, and that a malicious user cannot cause confusion in other ways.\n\nFor log entries that will be displayed in HTML, user input should be HTML encoded using `html.EscapeString` or similar before being logged, to prevent forgery and other forms of HTML injection.\n\n\n## Example\nIn the following example, a user name, provided by the user, is logged using a logging framework without any sanitization.\n\n\n```go\npackage main\n\nimport (\n\t\"log\"\n\t\"net/http\"\n)\n\n// BAD: A user-provided value is written directly to a log.\nfunc handler(req *http.Request) {\n\tusername := req.URL.Query()[\"username\"][0]\n\tlog.Printf(\"user %s logged in.\\n\", username)\n}\n\n```\nIn the next example, `strings.Replace` is used to ensure no line endings are present in the user input.\n\n\n```go\npackage main\n\nimport (\n\t\"log\"\n\t\"net/http\"\n\t\"strings\"\n)\n\n// GOOD: The user-provided value is escaped before being written to the log.\nfunc handlerGood(req *http.Request) {\n\tusername := req.URL.Query()[\"username\"][0]\n\tescapedUsername := strings.ReplaceAll(username, \"\\n\", \"\")\n\tescapedUsername = strings.ReplaceAll(escapedUsername, \"\\r\", \"\")\n\tlog.Printf(\"user %s logged in.\\n\", escapedUsername)\n}\n\n```\n\n## References\n* OWASP: [Log Injection](https://www.owasp.org/index.php/Log_Injection).\n* Common Weakness Enumeration: [CWE-117](https://cwe.mitre.org/data/definitions/117.html).\n",
      "security_severity_level": "high"
    },
    "tool": {
      "name": "CodeQL",
      "guid": null,
      "version": null
    },
    "most_recent_instance": {
      "ref": "refs/heads/master",
      "analysis_key": ".github/workflows/codeql-analysis.yml:analyze/language:go",
      "environment": "{}",
      "category": ".github/workflows/codeql-analysis.yml:analyze/language:go",
      "state": "dismissed",
      "commit_sha": "cddb5a007304123d8527f0e0a301e57fefd9cbca",
      "message": {
        "text": "This log entry depends on a user-provided value."
      },
      "location": {
        "path": "pkg/hookd/api/v1/provision/handler.go",
        "start_line": 79,
        "end_line": 79,
        "start_column": 29,
        "end_column": 48
      },
      "classifications": []
    },
    "instances_url": "https://api.github.com/repos/nais/deploy/code-scanning/alerts/10/instances",
    "dismissal_approved_by": null
  },
  "ref": "refs/heads/master",
  "commit_oid": "48410b5fc920ebcc15e1fbeab631477e01366180",
  "repository": {
    "id": 166402203,
    "node_id": "MDEwOlJlcG9zaXRvcnkxNjY0MDIyMDM=",
    "name": "deploy",
    "full_name": "nais/deploy",
    "private": false,
    "owner": {
      "login": "nais",
      "id": 29488289,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjI5NDg4Mjg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/29488289?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nais",
      "html_url": "https://github.com/nais",
      "followers_url": "https://api.github.com/users/nais/followers",
      "following_url": "https://api.github.com/users/nais/following{/other_user}",
      "gists_url": "https://api.github.com/users/nais/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nais/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nais/subscriptions",
      "organizations_url": "https://api.github.com/users/nais/orgs",
      "repos_url": "https://api.github.com/users/nais/repos",
      "events_url": "https://api.github.com/users/nais/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nais/received_events",
      "type": "Organization",
      "user_view_type": "public",
      "site_admin": false
    },
    "html_url": "https://github.com/nais/deploy",
    "description": "Nais deploy: multi-cluster Kubernetes deployments",
    "fork": false,
    "url": "https://api.github.com/repos/nais/deploy",
    "forks_url": "https://api.github.com/repos/nais/deploy/forks",
    "keys_url": "https://api.github.com/repos/nais/deploy/keys{/key_id}",
    "collaborators_url": "https://api.github.com/repos/nais/deploy/collaborators{/collaborator}",
    "teams_url": "https://api.github.com/repos/nais/deploy/teams",
    "hooks_url": "https://api.github.com/repos/nais/deploy/hooks",
    "issue_events_url": "https://api.github.com/repos/nais/deploy/issues/events{/number}",
    "events_url": "https://api.github.com/repos/nais/deploy/events",
    "assignees_url": "https://api.github.com/repos/nais/deploy/assignees{/user}",
    "branches_url": "https://api.github.com/repos/nais/deploy/branches{/branch}",
    "tags_url": "https://api.github.com/repos/nais/deploy/tags",
    "blobs_url": "https://api.github.com/repos/nais/deploy/git/blobs{/sha}",
    "git_tags_url": "https://api.github.com/repos/nais/deploy/git/tags{/sha}",
    "git_refs_url": "https://api.github.com/repos/nais/deploy/git/refs{/sha}",
    "trees_url": "https://api.github.com/repos/nais/deploy/git/trees{/sha}",
    "statuses_url": "https://api.github.com/repos/nais/deploy/statuses/{sha}",
    "languages_url": "https://api.github.com/repos/nais/deploy/languages",
    "stargazers_url": "https://api.github.com/repos/nais/deploy/stargazers",
    "contributors_url": "https://api.github.com/repos/nais/deploy/contributors",
    "subscribers_url": "https://api.github.com/repos/nais/deploy/subscribers",
    "subscription_url": "https://api.github.com/repos/nais/deploy/subscription",
    "commits_url": "https://api.github.com/repos/nais/deploy/commits{/sha}",
    "git_commits_url": "https://api.github.com/repos/nais/deploy/git/commits{/sha}",
    "comments_url": "https://api.github.com/repos/nais/deploy/comments{/number}",
    "issue_comment_url": "https://api.github.com/repos/nais/deploy/issues/comments{/number}",
    "contents_url": "https://api.github.com/repos/nais/deploy/contents/{+path}",
    "compare_url": "https://api.github.com/repos/nais/deploy/compare/{base}...{head}",
    "merges_url": "https://api.github.com/repos/nais/deploy/merges",
    "archive_url": "https://api.github.com/repos/nais/deploy/{archive_format}{/ref}",
    "downloads_url": "https://api.github.com/repos/nais/deploy/downloads",
    "issues_url": "https://api.github.com/repos/nais/deploy/issues{/number}",
    "pulls_url": "https://api.github.com/repos/nais/deploy/pulls{/number}",
    "milestones_url": "https://api.github.com/repos/nais/deploy/milestones{/number}",
    "notifications_url": "https://api.github.com/repos/nais/deploy/notifications{?since,all,participating}",
    "labels_url": "https://api.github.com/repos/nais/deploy/labels{/name}",
    "releases_url": "https://api.github.com/repos/nais/deploy/releases{/id}",
    "deployments_url": "https://api.github.com/repos/nais/deploy/deployments",
    "created_at": "2019-01-18T12:33:03Z",
    "updated_at": "2025-06-06T11:38:36Z",
    "pushed_at": "2025-06-06T11:39:32Z",
    "git_url": "git://github.com/nais/deploy.git",
    "ssh_url": "git@github.com:nais/deploy.git",
    "clone_url": "https://github.com/nais/deploy.git",
    "svn_url": "https://github.com/nais/deploy",
    "homepage": "https://doc.nais.io/build/how-to/build-and-deploy",
    "size": 4913,
    "stargazers_count": 2,
    "watchers_count": 2,
    "language": "Go",
    "has_issues": true,
    "has_projects": false,
    "has_downloads": true,
    "has_wiki": false,
    "has_pages": false,
    "has_discussions": false,
    "forks_count": 8,
    "mirror_url": null,
    "archived": false,
    "disabled": false,
    "open_issues_count": 4,
    "license": {
      "key": "mit",
      "name": "MIT License",
      "spdx_id": "MIT",
      "url": "https://api.github.com/licenses/mit",
      "node_id": "MDc6TGljZW5zZTEz"
    },
    "allow_forking": true,
    "is_template": false,
    "web_commit_signoff_required": false,
    "topics": ["kubernetes", "nais", "naiserator"],
    "visibility": "public",
    "forks": 8,
    "open_issues": 4,
    "watchers": 2,
    "default_branch": "master",
    "custom_properties": {}
  },
  "organization": {
    "login": "nais",
    "id": 29488289,
    "node_id": "MDEyOk9yZ2FuaXphdGlvbjI5NDg4Mjg5",
    "url": "https://api.github.com/orgs/nais",
    "repos_url": "https://api.github.com/orgs/nais/repos",
    "events_url": "https://api.github.com/orgs/nais/events",
    "hooks_url": "https://api.github.com/orgs/nais/hooks",
    "issues_url": "https://api.github.com/orgs/nais/issues",
    "members_url": "https://api.github.com/orgs/nais/members{/member}",
    "public_members_url": "https://api.github.com/orgs/nais/public_members{/member}",
    "avatar_url": "https://avatars.githubusercontent.com/u/29488289?v=4",
    "description": "Nav Application Infrastructure Service"
  },
  "enterprise": {
    "id": 371,
    "slug": "nav",
    "name": "Nav",
    "node_id": "MDEwOkVudGVycHJpc2UzNzE=",
    "avatar_url": "https://avatars.githubusercontent.com/b/371?v=4",
    "description": "",
    "website_url": "https://nav.no",
    "html_url": "https://github.com/enterprises/nav",
    "created_at": "2019-06-26T11:17:54Z",
    "updated_at": "2025-05-05T17:51:43Z"
  },
  "sender": {
    "login": "github",
    "id": 9919,
    "node_id": "MDEyOk9yZ2FuaXphdGlvbjk5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github",
    "html_url": "https://github.com/github",
    "followers_url": "https://api.github.com/users/github/followers",
    "following_url": "https://api.github.com/users/github/following{/other_user}",
    "gists_url": "https://api.github.com/users/github/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github/subscriptions",
    "organizations_url": "https://api.github.com/users/github/orgs",
    "repos_url": "https://api.github.com/users/github/repos",
    "events_url": "https://api.github.com/users/github/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github/received_events",
    "type": "Organization",
    "user_view_type": "public",
    "site_admin": false
  },
  "installation": {
    "id": 56621983,
    "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uNTY2MjE5ODM="
  }
}
